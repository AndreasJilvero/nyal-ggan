/*! hhtracker v1.1.9 | hittahem.se */
!function(e,t,r,n,s,i,a){!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||n.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return n.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";n.defineProperty(t,"__esModule",{value:!0});var s=function(e){return"[object Array]"===n.prototype.toString.call(e)};t.extend=function e(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t=t||{};for(var i=1;i<arguments.length;i++){var a=arguments[i];if(a)for(var o in a)a.hasOwnProperty(o)&&(t[o]="object"!=typeof a[o]||s(a[o])?a[o]:e(t[o],a[o]))}return t},t.find=function(e,t){return(Array.prototype.find||function(e){for(var t=n(this),r=t.length>>>0,s=arguments[1],i=0;i<r;i++){var a=t[i];if(e.call(s,a,i,t))return a}}).call(e,t)}},function(t,r,s){"use strict";n.defineProperty(r,"__esModule",{value:!0});var i=s(2),a=s(6),o=e._HHTrackerReference||"hhtracker",u=e.HHTrackerPlugins=e.HHTrackerPlugins||{},c=e[o]&&e[o].q||[],f=new i.Tracker(c,u);a.elementDatasetPolyfill(),e[o]=f.message,e.addEventListener("beforeunload",function(){f.message("send")},!1)},function(t,s,i){"use strict";n.defineProperty(s,"__esModule",{value:!0});var a=i(3),o=i(4),u=i(0),c=i(5),f=/(.+)\:(.+)/;s.providePlugin=function(t,r){var n=e[e._HHTrackerReference||"hhtracker"];"function"==typeof n&&n("provide",t,r)};var l=function(){return function(e,t){var n=this;this.messageTypes={require:function(e,t,r){var n=this.pluginList[e]?this.pluginList[e].c:null;return n&&(this.required[r||e]=new n(this,t,o.Sender,a.ArraySendBuffer)),null!==n},provide:function(e,t){return this.pluginList[e]||(this.pluginList[e]={c:t}),!0},send:function(){for(var e in this.required)this.required[e].triggerSend();return!0},get:function(e,t){return this.cookie.getInstance(function(n,s){s.getItem(e,function(e,n){if(e)t(e,null);else if(n.value){var s=n.value;try{var i=r.parse(s);t(null,i)}catch(e){t(null,s)}}else t(null,null)})}),!0},set:function(e,t,r){return this.cookie.getInstance(function(n,s){s.setItem(e,t,function(e,n){e?r&&r(e,null):!0===n.success?r&&r(null,t):r&&r("Failed to set value in store.",null)})}),!0}},this.checkMessages=function(e){var t=e.slice(0);for(e.length=0;t.length;){var r=t.shift();n.message.apply(n,r)}},this.assign=u.extend,this.find=u.find,this.message=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(f.test(e)){var s=f.exec(e),i=n.required[s[1]];if(i)return i.send.apply(n,[s[2]].concat(t)),void n.checkMessages(n.messages)}else if(n.messageTypes[e]&&n.messageTypes[e].apply(n,t))return void n.checkMessages(n.messages);n.messages.push([e].concat(t))},this.messages=[],this.pluginList=t,this.required={},this.cookie=new c.CrossDomainLocalStorage,this.checkMessages(e)}}();s.Tracker=l},function(e,t,s){"use strict";n.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this;this.count=function(){return e.buffer.length},this.getItems=function(){return e.buffer.slice(0)},this.batchPayloads=function(e){var t=e&&e.length>0?e:[];return r.stringify({events:t})},this.buffer=[]}return e.prototype.enqueue=function(e){this.buffer.push(e)},e.prototype.clear=function(){this.buffer.length=0},e.prototype.markAsSent=function(e){this.clear()},e}();t.ArraySendBuffer=i},function(e,t,s){"use strict";n.defineProperty(t,"__esModule",{value:!0});var o=s(0),u=function(){function e(e,t){var r=this;this.triggerSend=function(e){if(void 0===e&&(e=!0),r.buffer.count()>0){var t=r.buffer.getItems();r.sender(t,e)}r.lastSend=+new i,clearTimeout(r.timeoutHandler),r.timeoutHandler=null,r.retryAt=null},this.buffer=t,this.retryAt=null,this.lastSend=0,this.consecutiveErrors=0;this.config=o.extend({},{url:"",maxTimer:100,maxSize:1e6,type:"POST",headers:{}},e)}return e.prototype.send=function(e){var t=e,n=this.buffer.getItems(),s=this.buffer.batchPayloads(n);s&&s.length+r.stringify(t).length>this.config.maxSize&&this.triggerSend(),this.buffer.enqueue(t),this.setupTimer()},e.prototype.setupTimer=function(){var e=this;if(!this.timeoutHandler){var t=this.retryAt?a.max(0,this.retryAt-i.now()):0,r=a.max(this.config.maxTimer,t);this.timeoutHandler=setTimeout(function(){e.triggerSend()},r)}},e.prototype.setRetryTime=function(){var e;if(this.consecutiveErrors<=1)e=3;else{var t=(a.pow(2,this.consecutiveErrors)-1)/2,r=a.floor(a.random()*t*3)+1;e=a.max(a.min(r,3600),3)}var n=i.now()+1e3*e;this.retryAt=n},e.prototype.sender=function(e,t){var r=this;if(this.config.url){var n=new XMLHttpRequest,s=this.buffer.batchPayloads(e);for(var i in n.open(this.config.type,this.config.url,t),this.config.headers)n.setRequestHeader(i,this.config.headers[i]);n.onreadystatechange=function(){return r._xhrReadyStateChange(n,e)},n.send(s),this.buffer.markAsSent(e)}},e.prototype.resendPayload=function(e){var t=this;e&&0!==e.length&&(this.consecutiveErrors++,e.forEach(function(e){return t.buffer.enqueue(e)}),this.setRetryTime(),this.setupTimer())},e.prototype._xhrReadyStateChange=function(e,t){var r;4===e.readyState&&(e.status>=200&&e.status<400?this.consecutiveErrors=0:(r=e.status,[408,429,500,503].indexOf(r)>=0&&this.consecutiveErrors<2&&this.resendPayload(t)))},e}();t.Sender=u},function(s,a,o){"use strict";n.defineProperty(a,"__esModule",{value:!0});var u=function(){function n(){var n=this;this.handlers=[],this.ready=!1,this.messsages=[],this.messageId=0,this.channelId=void 0,this.receiveMessage=function(e){if(e.origin===n.targetOrigin&&e.data){var t=r.parse(e.data);if("hh-storage-proxy-iframe-ready"===t.id&&void 0===n.channelId){n.channelId=t.channelId,n.ready=!0;for(var s=0;s<n.handlers.length;s++)n.handlers[s](null,n),delete n.handlers[s]}else t.channelId===n.channelId&&n.resolveMessage(t)}},this.postMessage=function(e,t,s,i){if(n.ready){n.messageId++,n.messsages[n.messageId]=i;var a={channelId:n.channelId,id:n.messageId,action:e,key:t,value:s};n.iFrame.contentWindow.postMessage(r.stringify(a),n.targetOrigin)}},this.resolveMessage=function(e){n.messsages[e.id]&&(n.messsages[e.id]&&"function"==typeof n.messsages[e.id]&&n.messsages[e.id](null,e),delete n.messsages[e.id])},this.setItem=function(e,t,r){n.postMessage("set",e,t,r)},this.getItem=function(e,t){n.postMessage("get",e,null,t)};var s="hh-storage-proxy-"+(new i).getTime().toString();e.addEventListener?e.addEventListener("message",this.receiveMessage,!1):e.attachEvent("onmessage",this.receiveMessage);var a=this.iFrame=t.createElement("iframe");a.style.display="none",a.id=s,a.src="https://cdn-tracker.bostadsboxen.bonniernews.se/tracking/proxy.html",a.setAttribute("sandbox","allow-same-origin allow-scripts"),t.body.appendChild(a);var o=t.createElement("a");o.href=a.src;var u=o.port&&"80"!==o.port&&"443"!==o.port?":"+o.port:"";this.targetOrigin=o.protocol+"//"+o.hostname+u}return n.prototype.getInstance=function(e){this.ready?e(null,this):this.handlers.push(e)},n}();a.CrossDomainLocalStorage=u},function(e,r,i){"use strict";n.defineProperty(r,"__esModule",{value:!0}),r.elementDatasetPolyfill=function(){if(!(t.documentElement.dataset||n.getOwnPropertyDescriptor(s.prototype,"dataset")&&n.getOwnPropertyDescriptor(s.prototype,"dataset").get)){var e={enumerable:!0,get:function(){var e={},t=this.attributes;function r(e){return e.charAt(1).toUpperCase()}function s(){return this.value}function i(e,t){void 0!==t?this.setAttribute(e,t):this.removeAttribute(e)}for(var a=0;a<t.length;a+=1){var o=t[a];if(o&&o.name&&/^data-\w[\w-]*$/.test(o.name)){var u=o.name,c=o.value,f=u.substr(5).replace(/-./g,r);n.defineProperty(e,f,{enumerable:this.enumerable,get:s.bind({value:c||""}),set:i.bind(this,u)})}}return e}};n.defineProperty(s.prototype,"dataset",e)}}}])}(window,document,JSON,Object,HTMLElement,Date,Math);